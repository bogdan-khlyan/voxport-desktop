import{_ as f,o as l,c,a as i,u as h,b as m,F as w,r as S,d as v,e as k,n as x,t as y,f as C,g as I,w as $,h as L,i as B}from"./index-d01643d7.js";import{s as a}from"./servers.state-31b8d38b.js";import{h as D,u as R}from"./axios.config-9e97406b.js";import{u as g}from"./user.state-00e05dea.js";const V=""+new URL("../logo.jpg",import.meta.url).href,E={},M={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"};function N(t,e){return l(),c("svg",M,e[0]||(e[0]=[i("path",{d:"M12 6V18M18 12L6 12",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))}const F=f(E,[["render",N]]);const U={key:0,class:"servers"},z=["onClick"],P={class:"servers__add-btn"},T={__name:"Servers",setup(t){const e=h();function n(r){e.push(`/server/${r.id}`),a.currentServer=r}return(r,o)=>m(a).servers?(l(),c("div",U,[o[0]||(o[0]=i("div",{class:"servers__logo"},[i("img",{src:V,alt:""})],-1)),o[1]||(o[1]=i("hr",null,null,-1)),(l(!0),c(w,null,S(m(a).servers,s=>{var u,_,d;return l(),c("div",{class:x(["servers__item",{active:((u=m(a).currentServer)==null?void 0:u.id)===s.id}]),key:s.id,onClick:W=>n(s)},y((d=(_=s.name)==null?void 0:_[0])==null?void 0:d.toUpperCase()),11,z)}),128)),i("button",P,[v(F)])])):k("",!0)}},q=f(T,[["__scopeId","data-v-d3b1285c"]]);function p(t,e){if(t.meta)return{...t,data:t.data.map(r=>p(r,e))};if(t.attributes){const r={};return e.forEach(o=>{var s;return r[o]=(s=t.attributes)==null?void 0:s[o]}),r}const n={};return e==null||e.forEach(r=>n[r]=t==null?void 0:t[r]),n}const A={async getServers(){var t,e;try{const n=await D("/api/servers",{params:{"populate[rooms][populate]":"users","pagination[limit]":100}});a.servers=(e=(t=p(n,["id","name","rooms"]))==null?void 0:t.data)==null?void 0:e.map(r=>({...r,rooms:r.rooms.map(o=>{var u;const s=p(o,["id","name","users"]);return{...s,users:(u=s==null?void 0:s.users)==null?void 0:u.filter(_=>{var d;return _.id!==((d=g.user)==null?void 0:d.id)}),serverId:r.id}})}))}catch(n){throw console.log(n),n}}};const G={class:"default-layout"},H={class:"default-layout__servers"},J={class:"default-layout__content"},Q={__name:"DefaultLayout",setup(t){const e=C(),n=h();r();async function r(){var o;g.accessToken?(await R.getMe(),await A.getServers(),a.currentServer=e.params.serverId?a.servers.find(s=>s.id.toString()===e.params.serverId):null,a.currentRoom=e.params.roomId?(o=a.currentServer)==null?void 0:o.rooms.find(s=>s.id.toString()===e.params.roomId):null):await n.push("/login")}return(o,s)=>{const u=I("router-view");return l(),c("div",G,[i("div",H,[v(q)]),i("div",J,[v(u,null,{default:$(({Component:_})=>[(l(),L(B(_)))]),_:1})])])}}},j=f(Q,[["__scopeId","data-v-41fd11d3"]]);export{j as default};
